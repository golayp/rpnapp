var rpnapp=function(){var n;var t;var a;var e;var o;var i;var d={en:{beforeUnloadMsg:"Data not saved. Are-you sure you want to quit?",save:"Save",drop:"Delete",back:"Back"},fr:{beforeUnloadMsg:"Données non sauvegardées. Êtes-vous sûr de vouloir quitter?",save:"Sauvegarder",drop:"Supprimer",back:"Retour"}};var l=function(e){if(e==null||_.isUndefined(e)){e={}}_.defaults(e,{location:$("body"),drop:function(){},save:function(){},back:function(){window.history.go(-1)},binded:function(){m("model binded event")},addCustomBinding:function(n){},model:"model.json",modelKeyAttribute:"Id",track:true,addToolbar:true,language:"en",debug:false});n=e;a=d[n.language];if(n.track){$(window).on("beforeunload",function(){if(t.tracker().somethingHasChanged()){return a.beforeUnloadMsg}})}r();s();u();m("rpnapp successfully initied")};var r=function(){if(n.addToolbar){var t=false;var d=$('<div class="row"><div class="col-md-12"><div class="btn-toolbar"><div class="btn-group leftsided"></div><div class="btn-group pull-right"></div></div></div></div>');if($("#backBtn").length){i=$("#backBtn")}else{i=$('<button class="btn btn-default" id="backBtn"><span class="glyphicon glyphicon-chevron-left"></span>  '+a.back+"</button>");d.find(".btn-group.leftsided").append(i);t=true}if(n.track){if($("#saveBtn").length){e=$("#saveBtn")}else{e=$('<button class="btn btn-primary" id="saveBtn" data-bind="enable: (tracker().somethingHasChanged() || '+n.modelKeyAttribute+'()==0)"><span class="glyphicon glyphicon-save"></span> '+a.save+"</button>");d.find(".btn-group.leftsided").append(e);t=true}if($("#dropBtn").length){o=$("#saveBtn")}else{o=$('<button class="btn btn-danger" id="dropBtn" data-bind="enable: '+n.modelKeyAttribute+'()!=0"><span class="glyphicon glyphicon-trash"></span> '+a.drop+"</button>");d.find(".btn-group.pull-right").append(o);t=true}}if(t){n.location.append(d)}}};var s=function(){if(n.addToolbar){i.click(function(){n.back(c())});if(n.track){e.click(function(){if(n.save(c())){t.tracker().markCurrentStateAsClean()}});o.click(function(){k(null,function(){n.drop(c())})})}}};var u=function(){if(typeof n.model==="object"){f(n.model)}else if(typeof n.model==="string"){try{n.model=JSON.parse(n.model)}catch(t){$.getJSON(n.model,function(n){f(n)}).fail(function(){m("Error getting model from url "+n.model)})}}};var c=function(){return ko.mapping.toJS(t)};var f=function(a){t=ko.mapping.fromJS(a);n.addCustomBinding(t);if(n.track){t.tracker=new b(t)}ko.applyBindings(t);n.binded();m("model loaded successfully and binded to ui")};var p=function(a){t[n.modelKeyAttribute](a)};var b=function(n,t){t=t||ko.toJSON;var a=ko.observable(t(n));var e={somethingHasChanged:ko.dependentObservable(function(){return t(n)!=a()}),markCurrentStateAsClean:function(){a(t(n))}};return function(){return e}};var v=function(){if(n.track){return t.tracker().somethingHasChanged()}return false};var g=function(){if(n.track){return t.tracker().markCurrentStateAsClean()}return false};var m=function(t){if(n.debug){console.log(t)}};var k=function(n,t){if(n==null||_.isUndefined(n)){n={}}_.defaults(n,{title:"Title",content:"<p>Content</p>",validationBtn:{layout:"danger",label:'<span class="glyphicon glyphicon-ok"></span> Validate'}});$("#rpnappmodal").remove();var a=$('<div class="modal" id="rpnappmodal"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">'+n.title+'</h4></div><div class="modal-body">'+n.content+'</div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Annuler</button></div></div></div></div>');var e=$('<button type="button" class="btn btn-'+n.validationBtn.layout+'">'+n.validationBtn.label+"</button>");$(".modal-footer",a).append(e);$("body").append(a);e.click(function(){a.modal("hide");t()});a.modal()};return{updateKeyAttribute:p,launchModal:k,getModel:c,markModelAsClean:g,isDirty:v,log:m,init:l}}();
//# sourceMappingURL=rpnapp.0.0.1.min.js.map